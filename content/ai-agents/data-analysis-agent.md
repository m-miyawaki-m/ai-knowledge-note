---
title: "データ分析エージェント"
tags: [基礎, 設計, 構成要素, 安全性, パターン, ワークフロー, ツール, 全フェーズ]
created: 2026-02-25
updated: 2026-02-26
---

## データ分析業務の課題とエージェントの適用

データ分析業務では、BIツールの操作スキルが必要、複雑な分析はSQLやPythonの知識が要求される、分析の仮説構築に時間がかかるといった課題があります。[[AIエージェント]]は自然言語の指示からPythonコードを生成・実行し、結果を解釈してレポートを作成します。具体的な製品としては、OpenAIのAdvanced Data Analysis（旧Code Interpreter）、各社のBI AIアシスタントなどがあります。エージェントの設計では、[[シングルエージェントワークフロー]]が基本で、コード生成→実行→結果検証のサイクルを繰り返します。

## コード生成・実行・リフレクション

データ分析エージェントの中核は3つのステップのサイクルです。(1)コード生成：データの概要と分析目的をLLMに伝え、Pythonコード（pandas、matplotlib等）を生成。(2)コード実行：生成コードを[[E2B]]等のサンドボックス環境で実行。ホストシステムへの影響を隔離しつつ、ライブラリの利用やファイル操作を可能にする。(3)[[リフレクション]]：実行結果（出力、エラー、グラフ）をLLMに返し、コードの問題点を分析させて修正コードを生成。このサイクルを成功するまで繰り返します。[[Code Interpreter]]はこの一連のプロセスを統合的に提供する仕組みです。

## 分析レポートの作成

単発のコード実行を超えて、構造化された分析レポートを作成するには計画が必要です。(1)計画立案（仮説構築）：データの概要を分析し、「売上の季節変動パターンの特定」「顧客セグメントごとの購買傾向」等の分析仮説を生成。(2)仮説ごとのコード生成・実行：各仮説を検証するPythonコードを生成・実行し、グラフや統計結果を取得。(3)レポート生成：全ての実行結果を統合し、発見事項・考察・推奨アクションを含むMarkdownレポートを生成。この構造により、単なる集計を超えた洞察を提供できます。

## 課題と展望

データ分析エージェントの課題として、(1)データの前処理（欠損値処理、型変換）で予期しないエラーが発生しやすい、(2)生成されたグラフの解釈が浅い場合がある（相関と因果の混同等）、(3)大規模データではコード実行のリソース管理が必要。改善の方向性として、ドメイン知識をプロンプトに組み込むこと、分析パターンのテンプレート化、[[ヒューマンインザループ]]で分析の方向性を人間が確認することが有効です。将来的にはマルチモーダル（グラフの画像を直接AIが解釈）や、複数データソースを横断する分析への発展が期待されます。

## 用語

- **E2B (Code Sandbox)（E2B（コードサンドボックス））**: AIが生成したコードを安全に実行するためのクラウドサンドボックス環境。ホストシステムから隔離された環境でコードを実行し、結果を取得する。データ分析エージェントでの活用が代表的。
