---
title: "AIエージェントの活用"
tags: [運用, UX, 設計, 安全性, セキュリティ, リスク, モニタリング, ツール, 改善, 基礎, 構成要素, 評価]
created: 2026-02-25
updated: 2026-02-25
---

## AIエージェントとUX設計

[[エージェントUX]]は従来のUI/UXとは異なる設計原則が必要です。エージェントの実利用に至るまでのステップとして、(1)ユーザーがエージェントの能力範囲を理解する、(2)信頼関係を構築する（最初は簡単なタスクから）、(3)徐々に複雑なタスクを委任する。ユーザーとのタッチポイントの設計も重要で、(1)タスク投入時：何をしてほしいかの明確な入力手段、(2)処理中：何をしているかの可視化（進捗表示、使用ツールの表示）、(3)確認ポイント：重要な判断で[[ヒューマンインザループ]]の介入、(4)結果提示：根拠とともに結果を提示。エージェントの信頼性を高めるために、「わからないことはわからないと言う」「推測する場合はその旨を明示する」という透明性が重要です。

## リスクと安全性

エージェントのリスクは、(1)不正確な出力（[[ハルシネーション]]による誤った回答や行動）、(2)セキュリティリスク（[[プロンプトインジェクション]]による指示の乗っ取り）、(3)過剰な行動（許可範囲を超えた操作）、(4)情報漏洩（機密データの不適切な利用）。攻撃手法として、直接的プロンプトインジェクション（ユーザー入力での攻撃）と間接的プロンプトインジェクション（外部データに仕込まれた攻撃）があります。対策として[[ガードレール]]の実装が不可欠です。入力のサニタイズ、出力のバリデーション、アクションのホワイトリスト、コスト上限の設定、人間の承認フローを多層的に組み合わせます。

## モニタリングツール

エージェントの運用には継続的なモニタリングが不可欠です。(1)[[AgentOps]]：エージェント専用のモニタリングプラットフォーム。実行トレース、コスト追跡、パフォーマンス計測を統合的に提供。(2)[[Prompt Flow Tracing]]：Microsoftが提供するトレーシングツール。エージェントの各ステップをDAGとして可視化し、ボトルネックの特定に活用。(3)[[LangSmith]]：LangChainエコシステムのモニタリング。実行トレースの保存・検索、評価データセットの管理、プロンプトのバージョン管理が可能。これらのツールで、レイテンシ異常、エラー率上昇、コスト急増などを早期に検出し、対応できます。

## 継続的な精度改善

エージェントの品質は、デプロイ後も継続的に改善する必要があります。[[エージェントの自己改善]]のアプローチとして、(1)[[メモリ]]を活用した推論の改善：過去の成功・失敗パターンをメモリに蓄積し、類似のタスクで参照する。(2)ツールやプロンプトの改善：モニタリングデータから頻出のエラーパターンを特定し、ツールの説明文やプロンプトを調整する。(3)エージェントアーキテクチャの改善：ワークフローの構造自体を見直す（ノードの追加・削除・順序変更）。改善サイクルの確立には、[[評価]]→分析→改善→再評価のループを継続的に回す体制が必要です。

## 用語

- **Agent UX（エージェントUX）**: AIエージェントとユーザーの間のインタラクション設計。エージェントの処理過程の可視化、信頼性の構築、ユーザーの承認・介入ポイントの設計など、従来のUI/UXとは異なる設計原則が求められる。
- **Human-in-the-Loop（ヒューマンインザループ）**: エージェントの処理フローに人間の判断・承認ポイントを組み込む設計パターン。重要な意思決定や不可逆な操作の前に人間の確認を挟むことで、エージェントの安全性と信頼性を確保する。
- **Prompt Injection（プロンプトインジェクション）**: 悪意のある入力によってエージェントの指示を上書きし、意図しない動作を引き起こす攻撃手法。間接的プロンプトインジェクション（外部データ経由）は特に防御が難しく、エージェントのセキュリティ設計で最重要課題の一つ。
- **Guardrails（ガードレール）**: エージェントの行動を安全な範囲内に制限する仕組み。入力のフィルタリング、出力の検証、許可されたアクションのホワイトリスト、コスト上限の設定など、多層的な防御を構築する。
- **AgentOps（AgentOps）**: AIエージェントの運用を監視・管理するための概念・ツール群。エージェントの実行トレース、コスト追跡、パフォーマンス計測、異常検知などを包括的に行う。MLOpsのエージェント版。
- **Prompt Flow Tracing（Prompt Flow トレーシング）**: Microsoftが提供するPrompt flowのトレース機能。エージェントの各ステップ（LLM呼び出し、ツール実行、判断分岐）をDAGとして可視化し、ボトルネックの特定やデバッグに活用する。
- **LangSmith（LangSmith）**: LangChainチームが提供する、LLMアプリケーションの開発・テスト・モニタリングプラットフォーム。エージェントの実行トレースの可視化、プロンプトの管理、評価データセットの作成・実行が可能。
- **Agent Architecture Self-Improvement（エージェントの自己改善）**: エージェントが運用中の経験から学び、プロンプト・ツール選択・ワークフロー自体を改善する仕組み。メモリに蓄積された成功・失敗パターンを活用し、継続的にパフォーマンスを向上させる。
- **Agent Memory（エージェントメモリ）**: エージェントが過去の経験・会話履歴・学習した知識を保持する仕組み。短期メモリ（現在の会話コンテキスト）と長期メモリ（永続化された知識・経験）に分かれる。
- **Agent Evaluation（エージェント評価）**: AIエージェントの性能を定量的・定性的に評価するプロセス。エージェント能力（ツール使用、計画、記憶）と問題解決能力（タスクの完了度、正確性）の2軸で評価する。
