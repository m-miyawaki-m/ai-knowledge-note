---
title: "ルール・カスタム指示の活用"
tags: [基礎, ルール, 実践, 全フェーズ, プロンプト, 制約]
created: 2026-02-25
updated: 2026-02-25
---

## AIへの恒常的な指示とは

毎回のプロンプトに同じ指示を書くのは非効率です。[[システムプロンプト]]や[[カスタム指示]]の仕組みを使えば、プロジェクト全体に適用されるルールを一度定義するだけで済みます。例えばCLAUDE.mdや.cursorrules等のルールファイルに「コードはTypeScriptで書く」「変数名はcamelCaseを使う」「エラーメッセージは日本語にする」と定義しておけば、AIは常にこのルールに従います。これは人間の開発者にとってのコーディング規約と同じ位置づけで、AIとの協業における品質の基盤になります。

## ルールファイルに何を書くべきか

効果的なルールファイルには以下の要素を含めます。(1)プロジェクト概要：技術スタック、ディレクトリ構成、主要なライブラリ。(2)コーディング規約：命名規則、インデント、コメントルール。(3)アーキテクチャ方針：レイヤー構成、依存関係のルール、禁止パターン。(4)用語定義：プロジェクト固有の[[用語集]]への参照。(5)品質基準：テストカバレッジ目標、セキュリティ要件。これらを[[構造化]]された形式で記述し、AIが正確に解釈できるようにします。ルールが多すぎると[[コンテキストウィンドウ]]を圧迫するため、重要度に応じた取捨選択も必要です。

## ルールの階層化と使い分け

ルールは範囲に応じて階層化すると管理しやすくなります。全社レベル（セキュリティポリシー、共通コーディング規約）、プロジェクトレベル（技術スタック、アーキテクチャ方針）、タスクレベル（特定機能の実装方針）の3階層が一般的です。[[システムプロンプト]]に全社ルールを、プロジェクトのルールファイルにプロジェクトルールを、個々のプロンプトにタスクルールを配置します。この階層により、汎用的なルールの重複記述を避けつつ、各レベルで必要な指示を適切に伝えられます。ルールは定期的にレビューし、AIの出力品質に貢献しているか検証しましょう。

## 用語

- **System Prompt（システムプロンプト）**: AIモデルに対して会話全体を通じて適用される初期指示。役割、制約、出力形式などを定義する。ユーザーのプロンプトより優先度が高く、AIの基本的な振る舞いを制御する。
- **Custom Instructions（カスタム指示）**: CLAUDE.md、.cursorrules、.github/copilot-instructions.md等のファイルを通じてAIツールにプロジェクト固有のルールを伝える仕組み。コーディング規約、技術スタック、禁止事項などを恒常的に適用できる。
- **Glossary-Driven Development（用語集駆動開発）**: プロジェクト固有の用語集を作成・維持し、AIへの全ての入力に用語定義を含めることで出力の一貫性と正確性を担保する開発手法。用語集はコードと同様にバージョン管理する。
- **Structured Output（構造化出力）**: AIの出力をJSON、Markdown表、YAML等の構造化されたフォーマットで生成させる手法。後続の処理やツール連携が容易になり、出力の一貫性も向上する。
- **Context Window（コンテキストウィンドウ）**: AIモデルが一度に処理できるテキスト量の上限。設計書やコードを入力する際、この制限を意識して情報を分割・要約する必要がある。モデルにより数千〜数十万トークン。
